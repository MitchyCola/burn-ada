name: Generate Burn Address and NFT Minting Tx
on: 
  workflow_dispatch

# TODO: Create a job that will create a fork of the GitHub repository.
jobs:

  run_scripts:
    runs-on: ubuntu-latest
    steps:
    
    - name: Checkout Repository
      uses: actions/checkout@v2
      
    - name: Setup Haskell
      uses: haskell/actions/setup@v1
      with:
        ghc-version: '8.10.7'
        cabal-version: 'latest'
        
    - name: Generate Token Name
      working-directory: ./res/scripts
      run: |
        chmod +x token-name.sh
        ./token-name.sh
      shell: bash
        
    - name: Compile Plutus Script
      working-directory: ./res
      run: |
        cabal v2-update
        cabal v2-run burn-ada.cabal
      
    - name: Run Script Files
      working-directory: ./res/scripts
      run: |
         chmod +x `ls *.sh`
         ./rando-addr.sh
         ./gen-policyID.sh
         ./gen-metadata.sh
         ./build-tx-script.sh
      shell: bash
      
    - name: Upload Artifacts
      uses: actions/upload-artifact@v2
      with:
        name: Archived Outputs
        path: ./res/cache
        
  #  - name: Rename Local Branch
  #    run: git branch -m <auto-branch>
  # pull_request:
  #   needs: run_scripts
  #   runs-on: ubuntu-latest
